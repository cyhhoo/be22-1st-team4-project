-- 1. TBL_USERS 데이터 삽입
-- 사용자 A
INSERT INTO TBL_USERS (USER_CD, USER_ID, USER_PW, USER_NICK_NM, USER_EMAIL) VALUES
(100, 'userA', 'hashed_pw_A', 'OriginalWriterA', 'a@test.com');

-- 사용자 B
INSERT INTO TBL_USERS (USER_CD, USER_ID, USER_PW, USER_NICK_NM, USER_EMAIL) VALUES
(200, 'userB', 'hashed_pw_B', 'AttempterB', 'b@test.com');

-- 사용자 C
INSERT INTO TBL_USERS (USER_CD, USER_ID, USER_PW, USER_NICK_NM, USER_EMAIL) VALUES
(300, 'userC', 'hashed_pw_C', 'PlayerC', 'c@test.com');

-- 사용자 D
INSERT INTO TBL_USERS (USER_CD, USER_ID, USER_PW, USER_NICK_NM, USER_EMAIL) VALUES
(400, 'userD', 'hashed_pw_D', 'TesterD', 'd@test.com');

-- 관리자 E
INSERT INTO TBL_USERS (USER_CD, USER_ID, USER_PW, USER_NICK_NM, USER_EMAIL, USER_LV) VALUES
(500, 'managerD', 'hashed_pw_E', 'MngD', 'E@test.com', 5);

SELECT * FROM TBL_USERS;

-- 2. TBL_POST_CATEGORIES 데이터 삽입 (카테고리 생성) // 자유 게시판, 영화 리뷰, 스포일러
INSERT INTO TBL_POST_CATEGORIES (POST_CTGRY_CD, POST_CTGRY_NM) VALUES
(1, '자유 게시판'),
(2, '영화 리뷰'),
(3, '스포일러'),
(4, '공지사항');

-- 3. TBL_POSTS 데이터 삽입
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(1, 100, 1, '제목A1', 'aaaaaa', NOW(),100,10,300);
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(2, 200, 2, '제목B1', 'bbbbbbbb', NOW(),20,1,40);
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(3, 300, 2, '제목C1', 'ccc', NOW(),80,40,500);
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(4, 100, 3, '제목A2', 'AA', NOW(),99,23,1000);
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(5, 200, 1, '제목B2', 'BBBBB', NOW(),77,60,240);
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(6, 400, 2, '제목D1', 'ddddddd', NOW(),435,123,3000);
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(7, 300, 3, '제목C2', 'CCC', NOW(),23,12,35);
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(8, 200, 2, '제목B2', 'BB', NOW(),39,37,700);
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(9, 400, 3, '제목D2', 'DDDD', NOW(),89,23,400);
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM, POST_LIKE_CNT, POST_DISLIKE_CNT, POST_VIEW_CNT)
VALUES
(10, 300, 1, '제목C3', 'cccCCC', NOW(),789,22,5000);



-- 4. 공지사항 등록
-- 공지 3개 등록
INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM)
VALUES
(11, 500, 4, '공지1', '공지는 notice', NOW());

INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM)
VALUES
(12, 500, 4, '공지2', '공지는 note', NOW());

INSERT INTO TBL_POSTS (POST_CD, USER_CD, POST_CTGRY_CD, POST_TT, POST_CONT, POST_REG_DTTM)
VALUES
(13, 500, 4, '공지3', '공지는 공지', NOW());


/*
게시글 목록 조회() 시, 정렬 옵션을 **'최신순'**으로 선택.
단, 제일 위에 최신 공지사항 2개는 무조건 출력한다.
*/

(
    -- 1. POST_CTGRY_CD = 4 인 행 중 최신순 2개 출력 (카테고리명 및 닉네임 포함)
    SELECT
        A.POST_CD,
        B.POST_CTGRY_NM,
        A.POST_TT,
        U.USER_NICK_NM,  -- USER_CD 대신 닉네임 출력
        A.POST_REG_DTTM,
        A.POST_VIEW_CNT,
        (A.POST_LIKE_CNT - A.POST_DISLIKE_CNT) AS `NetLike` -- 별칭을 `NetLike`로 개선
    FROM TBL_POSTS A
    INNER JOIN TBL_POST_CATEGORIES B
        ON A.POST_CTGRY_CD = B.POST_CTGRY_CD
    INNER JOIN TBL_USERS U  -- TBL_USERS 테이블 조인 추가
        ON A.USER_CD = U.USER_CD
    WHERE A.POST_CTGRY_CD = 4
    ORDER BY A.POST_REG_DTTM DESC
    LIMIT 2
)
UNION ALL
(
    -- 2. POST_CTGRY_CD != 4 인 행 중 최신순 7개 출력 (카테고리명 및 닉네임 포함)
    SELECT
        A.POST_CD,
        B.POST_CTGRY_NM,
        A.POST_TT,
        U.USER_NICK_NM,  -- USER_CD 대신 닉네임 출력
        A.POST_REG_DTTM,
        A.POST_VIEW_CNT,
        (A.POST_LIKE_CNT - A.POST_DISLIKE_CNT) AS `NetLike` -- 별칭을 `NetLike`로 개선
    FROM TBL_POSTS A
    INNER JOIN TBL_POST_CATEGORIES B
        ON A.POST_CTGRY_CD = B.POST_CTGRY_CD
    INNER JOIN TBL_USERS U  -- TBL_USERS 테이블 조인 추가
        ON A.USER_CD = U.USER_CD
    WHERE A.POST_CTGRY_CD != 4
    ORDER BY A.POST_REG_DTTM DESC
    LIMIT 7
);

/*
게시글 목록 조회 시, 정렬 옵션을 **'조회수순'**으로 선택.
단, 제일 위에 최신 공지사항 2개는 무조건 출력한다.
*/

(
    -- 1. POST_CTGRY_CD = 4 인 행 중 최신순 2개 출력 (카테고리명 및 닉네임 포함)
    SELECT
        A.POST_CD,
        B.POST_CTGRY_NM,
        A.POST_TT,
        U.USER_NICK_NM,  -- USER_CD 대신 닉네임 출력
        A.POST_REG_DTTM,
        A.POST_VIEW_CNT,
        (A.POST_LIKE_CNT - A.POST_DISLIKE_CNT) AS `NetLike` -- 별칭을 `NetLike`로 개선
    FROM TBL_POSTS A
    INNER JOIN TBL_POST_CATEGORIES B
        ON A.POST_CTGRY_CD = B.POST_CTGRY_CD
    INNER JOIN TBL_USERS U  -- TBL_USERS 테이블 조인 추가
        ON A.USER_CD = U.USER_CD
    WHERE A.POST_CTGRY_CD = 4
    ORDER BY A.POST_REG_DTTM DESC
    LIMIT 2
)
UNION ALL
(
    -- 2. POST_CTGRY_CD != 4 인 행 중 최신순 7개 출력 (카테고리명 및 닉네임 포함)
    SELECT
        A.POST_CD,
        B.POST_CTGRY_NM,
        A.POST_TT,
        U.USER_NICK_NM,  -- USER_CD 대신 닉네임 출력
        A.POST_REG_DTTM,
        A.POST_VIEW_CNT,
        (A.POST_LIKE_CNT - A.POST_DISLIKE_CNT) AS `NetLike` -- 별칭을 `NetLike`로 개선
    FROM TBL_POSTS A
    INNER JOIN TBL_POST_CATEGORIES B
        ON A.POST_CTGRY_CD = B.POST_CTGRY_CD
    INNER JOIN TBL_USERS U  -- TBL_USERS 테이블 조인 추가
        ON A.USER_CD = U.USER_CD
    WHERE A.POST_CTGRY_CD != 4
    ORDER BY A.POST_VIEW_CNT DESC
    LIMIT 7
);


/*
게시글 목록 조회 시, 정렬 옵션을 **'추천순'**으로 선택.
단, 제일 위에 최신 공지사항 2개는 무조건 출력한다.
*/

(
    -- 1. POST_CTGRY_CD = 4 인 행 중 최신순 2개 출력 (카테고리명 및 닉네임 포함)
    SELECT
        A.POST_CD,
        B.POST_CTGRY_NM,
        A.POST_TT,
        U.USER_NICK_NM,  -- USER_CD 대신 닉네임 출력
        A.POST_REG_DTTM,
        A.POST_VIEW_CNT,
        (A.POST_LIKE_CNT - A.POST_DISLIKE_CNT) AS `NetLike` -- 별칭을 `NetLike`로 개선
    FROM TBL_POSTS A
    INNER JOIN TBL_POST_CATEGORIES B
        ON A.POST_CTGRY_CD = B.POST_CTGRY_CD
    INNER JOIN TBL_USERS U  -- TBL_USERS 테이블 조인 추가
        ON A.USER_CD = U.USER_CD
    WHERE A.POST_CTGRY_CD = 4
    ORDER BY A.POST_REG_DTTM DESC
    LIMIT 2
)
UNION ALL
(
    -- 2. POST_CTGRY_CD != 4 인 행 중 최신순 7개 출력 (카테고리명 및 닉네임 포함)
    SELECT
        A.POST_CD,
        B.POST_CTGRY_NM,
        A.POST_TT,
        U.USER_NICK_NM,  -- USER_CD 대신 닉네임 출력
        A.POST_REG_DTTM,
        A.POST_VIEW_CNT,
        (A.POST_LIKE_CNT - A.POST_DISLIKE_CNT) AS `NetLike` -- 별칭을 `NetLike`로 개선
    FROM TBL_POSTS A
    INNER JOIN TBL_POST_CATEGORIES B
        ON A.POST_CTGRY_CD = B.POST_CTGRY_CD
    INNER JOIN TBL_USERS U  -- TBL_USERS 테이블 조인 추가
        ON A.USER_CD = U.USER_CD
    WHERE A.POST_CTGRY_CD != 4
    ORDER BY (POST_LIKE_CNT - POST_DISLIKE_CNT) DESC
    LIMIT 7
);

-- 초기화
DELETE FROM TBL_POSTS;
DELETE FROM TBL_POST_CATEGORIES;
DELETE FROM TBL_USERS;